<!--
  ~ Copyright (C) 2024  Manh Tu VU
  ~
  ~ This program is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ This program is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with this program.  If not, see <https://www.gnu.org/licenses/>.
  -->
<div>
	<div class="modal-header text-center">
		<h4 class="modal-title w-100">Papyrus image segmentation</h4>
	</div>
	<div class="modal-body container" >
		<div class="row">
			<div class="col-sm-5">
				<div class="container">

					<h4 class="card-subtitle mb-2 text-body-secondary">Instruction:</h4>
					<p class="card-text mb-3"> Left click on the image to add a foreground point, right click to add a background point.
						Click on the save button to save the segmentation.</p>

					<h4 class="card-subtitle mb-2 mt-5 text-body-secondary">Registered segmentation points:</h4>
					<table class="table text-center table-sm">
						<tbody>
						<tr>
							<td>Foreground points</td>
							<td>Background points</td>
						</tr>
						<tr>
							<td>
								<ul class="list-group list-group-flush">
									<li class="list-group-item" *ngFor="let point of foregroundPoints">{{point.x | number:'1.0-0' | noComma}}, {{point.y | number:'1.0-0' | noComma}}</li>
									<li class="list-group-item" *ngIf="foregroundPoints.length === 0">-</li>
								</ul>
							</td>
							<td>
								<ul class="list-group list-group-flush">
									<li class="list-group-item" *ngFor="let point of backgroundPoints">{{point.x | number:'1.0-0' | noComma}}, {{point.y | number:'1.0-0' | noComma}}</li>
									<li class="list-group-item" *ngIf="backgroundPoints.length === 0">-</li>
								</ul>
							</td>
						</tr>
						</tbody>
					</table>
				</div>

			</div>
			<div class="col-sm-7 position-relative text-center" style="height: 65vh;">
				<div *ngIf="image" class="h-100">
					<img class="segment-img" #imgElement [src]="image.path" [alt]="image.name" style="max-width: 100%; max-height: 100%;"
							 (click)="performSegment($event, imgElement)" (contextmenu)="performSegment($event, imgElement)">
					<img class="segment-img blending-img" *ngIf="base64Img" [src]="base64Img" [alt]="image.name" style="max-width: 100%; max-height: 100%;"
							 (click)="performSegment($event, imgElement)" (contextmenu)="performSegment($event, imgElement)">
				</div>
				<div #mask class="position-absolute h-100 w-100 justify-content-center align-items-center" style="top: 0; left: 0; z-index: 10; background-color: rgba(0, 0, 0, .8); display: flex">
					<div class="spinner-border text-primary" role="status">
						<span class="sr-only"></span>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="modal-footer">
		<button type="button" class="btn btn-success btn-sm" (click)="onSave()">Save</button>
		<button type="button" class="btn btn-danger btn-sm" (click)="reset()">Reset</button>
		<button type="button" class="btn btn-secondary btn-sm" (click)="cancel()">Cancel</button>
	</div>
</div>